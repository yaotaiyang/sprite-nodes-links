!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("spritejs")):"function"==typeof define&&define.amd?define(["spritejs"],e):"object"==typeof exports?exports.spriteNodesLinks=e(require("spritejs")):t.spriteNodesLinks=e(t.spritejs)}(window,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function t(e,n,i){var o;if("object"==r(e)){if("array"===c(e)){o=[];for(var s=0,a=e.length;s<a;s++)o.push(t(e[s],n,i))}else if(null!==e)for(var u in o=Object.create(null),e)n&&"array"===c(n)&&n.length?-1!=n.indexOf(u)&&(o[u]=t(e[u],n,i)):n&&"regexp"===c(n)?n.test(u)&&(o[u]=t(e[u],n,i)):n&&"function"===c(n)?n(u,e[u])&&(o[u]=t(e[u],n,i)):i&&"array"===c(i)&&i.length?-1===i.indexOf(u)&&(o[u]=t(e[u],n,i)):i&&"regexp"===c(i)?i.test(u)||(o[u]=t(e[u],n,i)):i&&"function"===c(i)&&i(u,e[u])||(o[u]=t(e[u],n,i))}else o=e;return o;function c(t){var e=r(t);return"object"===e?null===t?null:Object.prototype.toString.call(t).slice(8,-1).toLowerCase():e}};e.default=i},function(t,e,n){window,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=65)}([function(t,e,n){var r=n(22)("wks"),i=n(23),o=n(1).Symbol,s="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=s&&o[t]||(s?o:i)("Symbol."+t))}).store=r},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){var n=t.exports={version:"2.6.10"};"number"==typeof __e&&(__e=n)},function(t,e){t.exports={}},function(t,e,n){var r=n(6),i=n(21);t.exports=n(5)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){t.exports=!n(19)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(7),i=n(40),o=n(41),s=Object.defineProperty;e.f=n(5)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(37),i=n(10);t.exports=function(t){return r(i(t))}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(22)("keys"),i=n(23);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e,n){n(34);for(var r=n(1),i=n(4),o=n(3),s=n(0)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var c=a[u],l=r[c],f=l&&l.prototype;f&&!f[s]&&i(f,s,c),o[c]=o.Array}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){"use strict";var r=n(17),i=n(18),o=n(42),s=n(4),a=n(3),u=n(43),c=n(25),l=n(52),f=n(0)("iterator"),d=!([].keys&&"next"in[].keys()),h=function(){return this};t.exports=function(t,e,n,p,v,y,m){u(n,e,p);var g,x,_,b=function(t){if(!d&&t in S)return S[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},w=e+" Iterator",k="values"==v,M=!1,S=t.prototype,O=S[f]||S["@@iterator"]||v&&S[v],L=O||b(v),E=v?k?b("entries"):L:void 0,j="Array"==e&&S.entries||O;if(j&&(_=l(j.call(new t)))!==Object.prototype&&_.next&&(c(_,w,!0),r||"function"==typeof _[f]||s(_,f,h)),k&&O&&"values"!==O.name&&(M=!0,L=function(){return O.call(this)}),r&&!m||!d&&!M&&S[f]||s(S,f,L),a[e]=L,a[w]=h,v)if(g={values:k?L:b("values"),keys:y?L:b("keys"),entries:E},m)for(x in g)x in S||o(S,x,g[x]);else i(i.P+i.F*(d||M),e,g);return g}},function(t,e){t.exports=!0},function(t,e,n){var r=n(1),i=n(2),o=n(38),s=n(4),a=n(8),u=function(t,e,n){var c,l,f,d=t&u.F,h=t&u.G,p=t&u.S,v=t&u.P,y=t&u.B,m=t&u.W,g=h?i:i[e]||(i[e]={}),x=g.prototype,_=h?r:p?r[e]:(r[e]||{}).prototype;for(c in h&&(n=e),n)(l=!d&&_&&void 0!==_[c])&&a(g,c)||(f=l?_[c]:n[c],g[c]=h&&"function"!=typeof _[c]?n[c]:y&&l?o(f,r):m&&_[c]==f?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(f):v&&"function"==typeof f?o(Function.call,f):f,v&&((g.virtual||(g.virtual={}))[c]=f,t&u.R&&x&&!x[c]&&s(x,c,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(11),i=n(1).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(2),i=n(1),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(17)?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(6).f,i=n(8),o=n(0)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){"use strict";var r=n(54)(!0);n(16)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e,n){var r=n(15),i=n(0)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector=e.Matrix=void 0;var r=o(n(29)),i=o(n(30));function o(t){return t&&t.__esModule?t:{default:t}}e.Matrix=r.default,e.Vector=i.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){t=t||[1,0,0,1,0,0],this.m=[t[0],t[1],t[2],t[3],t[4],t[5]]};r.prototype.unit=function(){return this.m=[1,0,0,1,0,0],this},r.prototype.multiply=function(t){var e,n=this.m;e=t instanceof r?t.m:t;var i=n[0]*e[0]+n[2]*e[1],o=n[1]*e[0]+n[3]*e[1],s=n[0]*e[2]+n[2]*e[3],a=n[1]*e[2]+n[3]*e[3],u=n[0]*e[4]+n[2]*e[5]+n[4],c=n[1]*e[4]+n[3]*e[5]+n[5];return n[0]=i,n[1]=o,n[2]=s,n[3]=a,n[4]=u,n[5]=c,this},r.prototype.inverse=function(){var t=new r(this.m),e=t.m,n=1/(e[0]*e[3]-e[1]*e[2]),i=e[3]*n,o=-e[1]*n,s=-e[2]*n,a=e[0]*n,u=n*(e[2]*e[5]-e[3]*e[4]),c=n*(e[1]*e[4]-e[0]*e[5]);return e[0]=i,e[1]=o,e[2]=s,e[3]=a,e[4]=u,e[5]=c,t},r.prototype.translate=function(t,e){return this.multiply([1,0,0,1,t,e])},r.prototype.rotate=function(t){var e=t*Math.PI/180,n=Math.cos(e),r=Math.sin(e);return this.multiply([n,r,-r,n,0,0])},r.prototype.skew=function(t,e){e|=0;var n=t*Math.PI/180,r=e*Math.PI/180,i=Math.tan(n),o=Math.tan(r);return this.multiply([1,o,i,1,0,0])},r.prototype.scale=function(t,e){return this.multiply([t,0,0,e,0,0])},r.prototype.transformPoint=function(t,e){var n=t,r=e;return[t=n*this.m[0]+r*this.m[2]+this.m[4],e=n*this.m[1]+r*this.m[3]+this.m[5]]},r.prototype.transformVector=function(t,e){var n=t,r=e;return[t=n*this.m[0]+r*this.m[2],e=n*this.m[1]+r*this.m[3]]},e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(31)),i=s(n(60)),o=s(n(61));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];(0,i.default)(this,t);var o=(0,r.default)(e,3),s=o[0],a=o[1],u=o[2],c=(0,r.default)(n,3),l=c[0],f=c[1],d=c[2];u=u||0,d=d||0,this.x=s-l,this.y=a-f,this.z=u-d}return(0,o.default)(t,[{key:"unit",value:function(){var e=this.length;return new t([this.x/e,this.y/e,this.z/e])}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"cross",value:function(e){var n=this.x,r=this.y,i=this.z,o=e.x,s=e.y,a=e.z;return new t([r*a-i*s,i*o-n*a,n*s-o*r])}},{key:"length",get:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)}}]),t}();e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var r=o(n(32)),i=o(n(56));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if(Array.isArray(t))return t;if((0,r.default)(Object(t)))return function(t,e){var n=[],r=!0,o=!1,s=void 0;try{for(var a,u=(0,i.default)(t);!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw s}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){t.exports={default:n(33),__esModule:!0}},function(t,e,n){n(14),n(26),t.exports=n(55)},function(t,e,n){"use strict";var r=n(35),i=n(36),o=n(3),s=n(9);t.exports=n(16)(Array,"Array",(function(t,e){this._t=s(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var r=n(15);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(39);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){t.exports=!n(5)&&!n(19)((function(){return 7!=Object.defineProperty(n(20)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(11);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){t.exports=n(4)},function(t,e,n){"use strict";var r=n(44),i=n(21),o=n(25),s={};n(4)(s,n(0)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(s,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(7),i=n(45),o=n(24),s=n(13)("IE_PROTO"),a=function(){},u=function(){var t,e=n(20)("iframe"),r=o.length;for(e.style.display="none",n(51).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=r(t),n=new a,a.prototype=null,n[s]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(6),i=n(7),o=n(46);t.exports=n(5)?Object.defineProperties:function(t,e){i(t);for(var n,s=o(e),a=s.length,u=0;a>u;)r.f(t,n=s[u++],e[n]);return t}},function(t,e,n){var r=n(47),i=n(24);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(8),i=n(9),o=n(48)(!1),s=n(13)("IE_PROTO");t.exports=function(t,e){var n,a=i(t),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;e.length>u;)r(a,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(9),i=n(49),o=n(50);t.exports=function(t){return function(e,n,s){var a,u=r(e),c=i(u.length),l=o(s,c);if(t&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e,n){var r=n(12),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){var r=n(12),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(1).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(8),i=n(53),o=n(13)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var r=n(10);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(12),i=n(10);t.exports=function(t){return function(e,n){var o,s,a=String(i(e)),u=r(n),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}}},function(t,e,n){var r=n(27),i=n(0)("iterator"),o=n(3);t.exports=n(2).isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(r(e))}},function(t,e,n){t.exports={default:n(57),__esModule:!0}},function(t,e,n){n(14),n(26),t.exports=n(58)},function(t,e,n){var r=n(7),i=n(59);t.exports=n(2).getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return r(e.call(t))}},function(t,e,n){var r=n(27),i=n(0)("iterator"),o=n(3);t.exports=n(2).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";e.__esModule=!0;var r,i=(r=n(62))&&r.__esModule?r:{default:r};e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()},function(t,e,n){t.exports={default:n(63),__esModule:!0}},function(t,e,n){n(64);var r=n(2).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){var r=n(18);r(r.S+r.F*!n(5),"Object",{defineProperty:n(6).f})},function(t,e,n){"use strict";n.r(e);var r=n(28);let i=null,o=[];const s=Symbol("mouseDown"),a=Symbol("mouseMove"),u=Symbol("mouseUp"),c=Symbol("isDraggable"),l=Symbol("isDroppable"),f=Symbol("isDragenter"),d=Symbol("dragRect");function h(t,e){return e&&void 0!==e.dragRect&&(t[d]=e.dragRect),e&&e.destroy||!1===e?t[c]?(delete t[c],t.removeEventListener("mousedown",t[s],!1).removeEventListener("mousemove",t[a],!1).removeEventListener("mouseup",t[u],!1)):t:t[c]?void 0:(t[c]=!0,t[s]=function(e){if(e.originalEvent&&3===e.originalEvent.which)return;if(e.stopPropagation(),(i=function t(e){return e[c]?e:"layer"===e.tarName?null:e.parent?t(e.parent):null}(e.target))!==t)return;const[n,r]=t.getOffsetPosition(e.x,e.y);i.x0_=n,i.y0_=r,i.dispatchEvent("dragstart",v(e),!0,!0),i.setMouseCapture()},t[a]=function(e){if(i&&i===t&&null!=i.x0_){const[n,s]=t.getOffsetPosition(e.x,e.y);let a=n-t.x0_,u=s-t.y0_;const[c,l]=t.attr("pos"),h=new r.Matrix(t.transformMatrix);[a,u]=h.transformPoint(a,u);let[p,m,g,x]=t[d]||[],_=c+a,b=l+u;void 0!==p&&(_=Math.max(p,_)),void 0!==g&&(_=Math.min(g,_)),void 0!==m&&(b=Math.max(m,b)),void 0!==x&&(b=Math.min(x,b)),t.attr({x:_,y:b}),i.dispatchEvent("drag",v(e),!0,!0),function(t,e){t.dragItem=e,o.forEach(n=>{if(e!==n){let r=y(e,n);r&&!n[f]?(n[f]=!0,n.dispatchEvent("dragenter",v(t),!0,!0)):!r&&n[f]?(delete n[f],n.dispatchEvent("dragleave",v(t),!0,!0)):r&&n[f]&&n.dispatchEvent("dragover",v(t),!0,!0)}})}(e,t)}},t[u]=function(e){i&&null!=i.x0_&&(i.releaseMouseCapture(),delete i.x0_,delete i.y0_,i.dispatchEvent("dragend",v(e),!0,!0),function(t,e){t.dragItem=e,o.forEach(n=>{y(e,n)&&n[f]&&(delete n[f],n.dispatchEvent("drop",v(t),!0,!0))})}(e,t)),i=null},t.addEventListener("mousedown",t[s],!1).addEventListener("mousemove",t[a],!1).addEventListener("mouseup",t[u],!1))}function p(t,e){if(e&&e.destroy||!1===e){if(t[l]){delete t[l];const e=o.indexOf(t);-1!==e&&o.splice(e,1)}}else t[l]||(o.push(t),t[l]=!0);return t}function v(t){return{detail:t}}function y(t,e){let{top:n,left:r,width:i,height:o}=t.getBoundingClientRect(),s=[r+i/2,n+o/2];return e.isPointCollision(s[0],s[1])}function m(t){const e=t.Node;Object.assign(e.prototype,{draggable:function(t){h(this,t)},droppable:function(t){p(this,t)}})}n.d(e,"install",(function(){return m})),n.d(e,"draggable",(function(){return h})),n.d(e,"droppable",(function(){return p}))}])},function(t,e,n){"use strict";n.r(e);var r=n(0);function i(t){const e=typeof t;return"object"===e?null===t?null:Object.prototype.toString.call(t).slice(8,-1).toLowerCase():e}function o(t,e){return Math.sqrt((e[0]-t[0])**2+(e[1]-t[1])**2)}var s=n(2),a=n(1),u=n.n(a);r.Node.prototype.clear=function(){for(let t=0;t<this.children.length;t++)this.children[t].remove(),t--};class c extends r.Node{constructor(t){super(),this.attr(t),this.sizeBox=[0,0,0,0],this.renderBox=[0,0,0,0],this.__attrs=u()(null),this.__isDragging=!1,this.container=new r.Group,this.container.attr({size:[.1,.1]}),this.addEventListener("mounted",this.mounted),this.addEventListener("drag",()=>{const[t,e]=this.container.attr("pos");this.renderBox=[t+this.sizeBox[0],e+this.sizeBox[1],t+this.sizeBox[2],e+this.sizeBox[3]]})}addEventListener(t,e){super.addEventListener(t,e);-1!==["click","dblclick","mouseenter","mouseleave","mousemove","mousedown","contextmenu","dragstart","drag","dragend","dragover","dragenter","dragleave","drop"].indexOf(t)&&this.container.addEventListener(t,(...n)=>{"drag"===t?this.__isDragging=!0:"dragend"===t&&setTimeout(t=>{this.__isDragging=!1}),this.__isDragging&&"click"===t||e(...n)})}pointCollision(){return!0}append(t){"array"===i(t)?t.forEach(t=>{this.container.append(t)}):this.container.append(t)}attr(t,e){return void 0===t&&void 0===e?this.__attrs:void 0===e&&"string"===i(t)?this.__attrs[t]:void("object"===i(t)?this.__attrs=Object.assign(u()(this.__attrs||{}),t):"string"===i(t)&&void 0!==e&&(this.__attrs[t]=e))}draggable(t){Object(s.draggable)(this.container,t)}remove(){console.error("you must overwrite this function remove()")}render(){return this.container.clear(),this.draw(),this.container}draw(){console.error("you must overwrite this function draw()")}mounted(){this.reSize()}reSize(){let t=this.container,[e,n,r,i]=[0,0,0,0];if(t.layer){let{width:r,height:i}=t.layer.getResolution();e=r/t.layer.displayRatio,n=i/t.layer.displayRatio}let[o,s]=this.container.attr("pos");t.children.length>0&&t.children.forEach(t=>{if(!1!==t.attr("layout")&&t.mesh){const[o,s,a,u]=t.originalClientRect;e=Math.min(e,o),n=Math.min(n,s),r=Math.max(r,o+a),i=Math.max(i,s+u)}}),this.sizeBox=[e,n,r,i],this.renderBox=[o+e,s+n,o+r,s+i]}}var l=c;var f=class extends l{constructor(t){super(t),this.attr(t),this.$line=null}draw(){this.$line=new r.Polyline,this.$line.attr({lineWidth:1,strokeColor:"#000"}),this.append(this.$line),this.move()}move(){let{startId:t,endId:e}=this.attr(),n=this.stage.nodes.filter(e=>e.attr("id")===t)[0],r=this.stage.nodes.filter(t=>t.attr("id")===e)[0];if(n&&r){let t=n.container.attr("pos"),e=r.container.attr("pos");this.$line&&this.$line.attr({points:[t,e]})}}remove(){let t=this.stage,e=t.links;for(let n=0;n<e.length;n++)e[n]===this&&(t.container.removeChild(e[n].container),e.splice(n,1))}};var d=class extends l{constructor(t){super(t);let e=Object.assign({text:"node",pos:[0,0],weight:1,fixed:!1,forceLink:[1,2],forceAxis:""},t);this.attr(e);let{id:n,draggable:r}=e;n||this.attr("id","xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))),!1!==r&&this.draggable();let{pos:i}=e;this.container.attr({pos:i,zIndex:100}),this.addEventListener("drag",t=>{this.__dragging=!0,this.attr("pos",this.container.attr("pos")),this.stage.checkForceLink(!0)}),this.addEventListener("dragstart",t=>{this.container.attr({zIndex:110})}),this.addEventListener("dragend",t=>{this.stage.nodes.forEach(t=>{t===this?this.container.attr({zIndex:101}):t.container.attr({zIndex:100})}),this.__dragging=!1,this.stage.checkForceLink(!0)})}moveLink(){let t=this.attr("id");this.stage&&this.stage.links&&this.stage.links.forEach(e=>{let{startId:n,endId:r}=e.attr();n!==t&&r!==t||e.move()})}attr(t,e){let n=super.attr(t,e);if("object"===i(t))for(let e in t)"pos"===e&&this.container&&(this.container.attr(e,t[e]),this.moveLink());else"pos"===t&&this.container&&(this.container.attr(t,e),this.moveLink());return n}draw(){let t=this.attr("text"),e=new r.Label(t);e.attr({border:[1,"#ccc"],fontFamily:"Arial",fontSize:14,padding:[2,6],bgcolor:"#fff",borderRadius:[5],anchor:[.5]}),this.$label=e,this.append(e)}mounted(){super.mounted();let[t,e,n,r]=this.sizeBox;this.forceDistance=Math.sqrt((n-t)**2+(r-e)**2)/2}remove(){let t=this.stage,e=t.nodes,n="";for(let r=0;r<e.length;r++)e[r]===this&&(t.container.removeChild(e[r].container),n=e[r].attr("id"),e.splice(r,1));n&&t.links.forEach(t=>{let{startId:e,endId:r}=t.attr();n!==e&&n!==r||t.remove()})}};let h=null,p=null;Date.now||(Date.now=function(){return(new Date).getTime()}),function(){let t=["webkit","moz"];for(let e=0;e<t.length&&!window.requestAnimationFrame;++e){let n=t[e];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){let t=0;window.requestAnimationFrame=function(e){let n=Date.now(),r=Math.max(t+16,n);return setTimeout((function(){e(t=r)}),r-n)},window.cancelAnimationFrame=clearTimeout}h=window.requestAnimationFrame,p=window.cancelAnimationFrame}();function v(){this.__tickId=h(v.bind(this)),this()}var y=class{constructor(){this.tasks=[]}add(t){-1===this.tasks.indexOf(t)&&this.tasks.push(t),v.bind(t)()}remove(t){let e=t;for(let n=0;n<this.tasks.length;n++)if(this.tasks[n]===t){e=this.tasks[n],this.tasks.splice(n,1);break}this.stop(e)}stop(t){void 0!==t?p(t.__tickId):this.tasks.forEach(t=>{this.stop(t)})}start(t){void 0!==t?this.add(t):this.tasks.forEach(t=>{v.bind(t)()})}clear(){this.stop(),this.tasks=[]}};let m=0,g=0;function x(t){let e=this.nodes.filter(t=>"none"!==t.container.attr("display")),n=this.links,r=this.nodes.map(t=>({...u()(t.__attrs),__pos:t.__attrs.pos,...u()(t,["renderBox","__dragging","sizeBox","forceDistance"])})),i=n.map(t=>t.__attrs),s=!0;if(t){s=_(r,i);let t=!1;r.forEach(e=>{e.__pos&&o(e.pos,e.__pos)>.01&&(e.pos=e.__pos,t=!0)}),t?e.forEach(t=>{let e=r.filter(e=>e.id===t.__attrs.id);e&&e.length&&t.attr({pos:e[0].pos})}):s=!1}else m=0,function t(e,n){let r=_(e,n);(m<=50||r&&m<1e3)&&(m++,e.forEach(t=>{t.__pos&&(t.pos=t.__pos)}),t(e,n))}(r,i),e.forEach(t=>{let e=r.filter(e=>e.id===t.__attrs.id);e&&e.length&&t.attr({pos:e[0].pos})}),s=!1;g++,s||t&&g<=50||(this.dispatchEvent("animateComplete",u()(null)),g=0,this.tick.clear(),this.reSize())}function _(t,e){let n=!1,r=!1;for(let i=0;i<t.length;i++){let o=t[i],s=o.forceLink;if(s&&void 0!==s[0])for(let e=i+1;e<t.length;e++){let n=t[e],i=n.forceLink;i&&void 0!==i[0]&&(r=w(o,n,s,i))}if(s&&void 0!==s[1])for(let r=i+1;r<t.length;r++){let i=t[r],a=i.forceLink;if(a&&void 0!==a[1]){let t=!1;for(let n=0;n<e.length;n++){let{startId:r,endId:s}=e[n];if(r===o.id&&s===i.id){t=!0;break}if(s===o.id&&r===i.id){t=!0;break}}t&&(n=b(o,i,s,a))}}}return n||r}function b(t,e,n,r){let{forceDistance:i,__pos:s}=t,{forceDistance:a,__pos:u}=e,c=o(s,u),l=i*n[1]+a*r[1];if(c>l+.01)return k(t,e,c,l)}function w(t,e,n,r){let{forceDistance:i,__pos:s}=t,{forceDistance:a,__pos:u}=e,c=o(s,u),l=i*n[0]+a*r[0];return 0===c?(t.__pos=[s[0]+Math.random()-.5,s[1]+Math.random()-.5],!0):c<l-.01?k(t,e,c,l):void 0}function k(t,e,n,r){let i=!1,{__pos:o,weight:s}=t,{__pos:a,weight:u}=e,c=n-r;if(t.__dragging||e.__dragging){let n=t,r=o,s=a;t.__dragging&&(n=e,r=a,s=o),M(n,r,s,c)&&(i=!0)}else{let n=c*s/(s+u),r=c*u/(s+u);n&&M(t,o,a,n)&&(i=!0),r&&M(e,a,o,r)&&(i=!0)}return i}function M(t,e,n,r){if(!t.fixed){let i=function(t,e,n){const[r,i]=t,[o,s]=e,a=Math.sqrt((r-o)*(r-o)+(i-s)*(i-s));return[n*(o-r)/a+r,n*(s-i)/a+i]}(e,n,r/2),o=t.forceAxis;return"y"===o?i[0]=t.pos[0]:"x"===o&&(i[1]=t.pos[1]),t.__pos=i,!0}}function S(t,e){let n,r,i,o,s=!1;t.addEventListener("mousedown",t=>{3!==t.originalEvent.which&&(n=t.x,r=t.y,[i,o]=e.attr("pos"),s=!0)}),t.addEventListener("mousemove",t=>{if(s){let s=t.x-n,a=t.y-r;e.transition(0).attr({pos:[i+s,o+a]}),this.reSize()}}),t.addEventListener("mouseleave",t=>{s=!1}),t.addEventListener("mouseup",t=>{s=!1}),t.addEventListener("mousewheel",t=>{t.preventDefault();const[n]=e.attr("scale");let[r,i]=e.attr("size"),o=1;t.originalEvent.wheelDelta<0&&(o=-1);const s=.3*o,[a,u]=e.attr("anchor");let c=(a*r+t.offsetX)/r,l=(u*i+t.offsetY)/i;const[f,d]=e.attr("pos");let h=r*s*c,p=i*s*l;const v=this.attr("zoom");n+s>v[0]&&n+s<v[1]&&e.transition(0).attr({scale:[n+s,n+s],pos:[f-h,d-p]})})}var O=class extends l{constructor(t){super(t);let e=Object.assign({selector:"",zoom:[.5,2],forceLink:!1,layout:[]},t);this.attr(e);let{selector:n,size:o}=e,s=n;"string"==typeof n&&(s=document.querySelector(n));let a=new r.Scene({container:s,displayRatio:window.devicePixelRatio});this.scene=a,this.$dom=s,this.nodes=[],this.links=[],this.tick=new y,this.__forceAni=!1,this.containers=[this.container],this.layers=Object.create(null),this.layers.default=a.layer("default"),this.layers.default.append(this.container),this.checkForceLink=function(t,e=500){let n=null,r=!0;return function(...i){if(r)return t.apply(this,i),r=!1;n||(n=setTimeout(()=>{clearTimeout(n),n=null,t.apply(this,i)},e))}}(t=>{let e=this.attr("forceLink");if("boolean"===i(t)&&(this.__forceAni=t),e){let t=!1;for(let e=0;e<this.nodes.length;e++){let n=this.nodes[e].attr("forceLink");if(n&&n.length>0){t=!0;break}}t&&(this.tick.clear(),this.tick.add(x.bind(this,this.__forceAni)))}},0),!1!==this.attr("zoom")&&this.containers.forEach(t=>{S.call(this,t.layer,t)}),window.addEventListener("resize",this.reLayout.bind(this))}reLayout(){return this.scene.setResolution(),this}reSize(){let t=this.container,[e,n,r,i]=[0,0,0,0];if(t.layer){let{width:r,height:i}=t.layer.getResolution();e=r/t.layer.displayRatio,n=i/t.layer.displayRatio}let[o,s]=this.container.attr("pos");this.nodes.length>0&&this.nodes.forEach(t=>{if(!1!==t.attr("layout")){const[o,s,a,u]=t.renderBox;e=Math.min(e,o),n=Math.min(n,s),r=Math.max(r,o+a),i=Math.max(i,s+u)}}),this.sizeBox=[e,n,r,i],this.renderBox=[o+e,s+n,o+r,s+i]}append(t){if(void 0===t)return;if("array"===i(t))return void t.forEach(t=>{this.append(t)});if(t.stage=this,t.$parent=this.container,t instanceof d){let e=this.nodes,n=t.attr("id");for(let t=0;t<e.length;t++){if(e[t].attr("id")===n)return void console.warn(`exist the same Step(id:${n}),please remove it first `)}e.push(t)}else if(t instanceof f){let e=this.links,{startId:n,endId:r}=t.attr();for(let t=0;t<e.length;t++){let{startId:i,endId:o}=e[t].attr();if(i===n&&o===r)return void console.warn(`exist the same Link(startId:${n},endId:${r}),please remove it first `)}if(n===r)return void console.warn(`the  Link(startId:${n}),has the same startId and endId `);e.push(t)}let e=t.render();e.addEventListener("afterrender",(function(){t.dispatchEvent("mounted",{})})),this.container.append(e)}clear(){this.steps=[],this.links=[],this.container.clear()}};n.d(e,"Link",(function(){return f})),n.d(e,"Stage",(function(){return O})),n.d(e,"Node",(function(){return d}))}])}));
//# sourceMappingURL=index.js.map